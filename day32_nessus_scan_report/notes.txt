##############################################
# ğŸ§© DAY 32 â€“ NESSUS VULNERABILITY REPORTS
##############################################

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# STEP 1 â€“ Confirm Nessus is running
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
sudo systemctl status nessusd --no-pager
sudo ss -tulpn | grep 8834

# If stopped:
sudo systemctl restart nessusd

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# STEP 2 â€“ Access Nessus Web UI
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Browser:
#   https://localhost:8834/
#   or https://<SERVER_IP>:8834/
# Login with your Nessus admin user.

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# STEP 3 â€“ Review your last scan results
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Dashboard â†’ Scans â†’ Completed Scan â†’ Click scan name
# Youâ€™ll see:
#   - Total vulnerabilities
#   - Severity breakdown (Critical / High / Medium / Low / Info)
#   - Hosts affected

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# STEP 4 â€“ Export report (multiple formats)
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# In web UI â†’ top-right corner â†’ â€œExportâ€
# Choose one of:
#   - HTML  â†’ readable report
#   - CSV   â†’ for Excel / Splunk analysis
#   - PDF   â†’ for documentation

# OR via CLI (for automation):
sudo /opt/nessus/sbin/nessuscli report --help

# Example: Export all scan results (adjust filename)
sudo /opt/nessus/sbin/nessuscli report --export /opt/nessus/var/nessus/users/admin/reports --format pdf --output /tmp/nessus_report.pdf

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# STEP 5 â€“ Understand Severity Levels
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Nessus classifies vulnerabilities using CVSS (0â€“10):
#   - Critical (9.0â€“10.0): Remote code execution, privilege escalation
#   - High     (7.0â€“8.9): Exploitable flaws, sensitive data leaks
#   - Medium   (4.0â€“6.9): Weak encryption, missing patches
#   - Low      (0.1â€“3.9): Minor misconfigurations
#   - Info     (0.0): Non-vulnerability system info

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# STEP 6 â€“ Identify CVEs and plugins
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Each finding lists:
#   - CVE ID (Common Vulnerabilities & Exposures)
#   - Plugin ID (unique Nessus script)
#   - Description & solution link

# Example search:
#   CVE-2023-38408 â†’ OpenSSH vulnerability
#   CVE-2021-44228 â†’ Log4Shell (critical Java exploit)

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# STEP 7 â€“ Prioritize remediation
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Strategy:
#   1. Fix Criticals first (especially public CVEs)
#   2. Update OS & services (apt/yum update)
#   3. Patch web-facing applications
#   4. Document the patch in your tracking file

# Example patch commands:
sudo apt update && sudo apt upgrade -y
sudo systemctl restart apache2 nginx ssh

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# STEP 8 â€“ Create a vulnerability baseline report
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
mkdir -p ~/nessus_reports
sudo cp /tmp/nessus_report.pdf ~/nessus_reports/day32_report_$(date +%F).pdf

# Optional: list all exported reports
ls -lh ~/nessus_reports

##############################################
# âœ… END OF DAY 32 â€“ NESSUS REPORTS
##############################################
